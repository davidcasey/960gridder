/*
 * Release: 1.3.2 2014-05-15
 */
/*
 * Copyright (c) Andr?e Hansson (peolanha AT gmail DOT com)
 * MIT License - http://www.opensource.org/licenses/mit-license.php
 * Idea loosely based on JASH, http://billyreisinger.com/jash/
 *
 * Website: http://gridder.andreehansson.se/
 *
 * Changelog:
 * - New GUI! The new GUI should be less obtrusive and has been repositioned.
 *   It is also featuring a slight delay on inputs so that you'll have a chance
 *   to change the settings before it is re-rendering the grid
 * - Due to a lot of inquries regarding affiliation with jQuery the filenames has
 *   been changed, I'm very sorry for the inconvenience!
 * - CSS issues with the GUI should also be fixed in more websites, please report
 *   in any issue you stumble upon
 * - A small bug in IE that made the paragraph lines not position correctly has been
 *   fixed
 * - A dropdown box has replaced the columns input box, 960 Gridder calculates the
 *   proper number of columns that can be used with the specified grid width
 * - The 960 Gridder is now displaying perfectly (into the very pixels) in all
 *   A-grade browsers (according to browsershots.org)
 * - An option to invert the gutters has been added, set this to 'true' if
 *   you want to use it, OR use the shortcut CTRL+ALT+A
 * - Some other minor changes...
 */
function Grid(){var e=this;e.settingsDef={urlBase:"http://gridder.andreehansson.se/releases/1.3.1/",gColor:"#EEEEEE",gColumns:12,gOpacity:.45,gWidth:10,pColor:"#C0C0C0",pHeight:15,pOffset:0,pOpacity:.55,center:true,invert:false,gEnabled:true,pEnabled:true,size:960,fixFlash:true,setupEnabled:true,pressedKeys:[],delayTimer:""};e.settings=typeof window.gOverride==="undefined"?{}:window.gOverride;for(var t in e.settingsDef){if(typeof e.settings[t]==="undefined"){e.settings[t]=e.settingsDef[t]}}if(typeof window.jQuery==="undefined"||jQuery().jquery.match(/^1\.3/)===null){window.jQuery=undefined;var n=document.createElement("script");n.type="text/javascript";n.src=e.settings.urlBase+"jquery.js";document.body.appendChild(n)}e._createEntity=function(e,t){jQuery('<div class="g-'+e+'">&nbsp;</div>').appendTo("#g-grid").css(t)};e._setVariable=function(t,n){t=t.replace(/g-setup-/,"");if(isNaN(parseInt(n,10))||parseInt(n,10)===0){e.settings[t]=n}else{e.settings[t]=parseInt(n,10)}if(n===true){jQuery("#g-setup-"+t).attr("checked","checked")}else if(n===false){jQuery("#g-setup-"+t).removeAttr("checked")}else{jQuery("#g-setup-"+t).val(n)}};e.setupWindow=function(){jQuery('<style type"text/css">#g-setup{position:absolute;top:150px;left:-310px;padding:6px;margin:0;list-style:none;width:320px!important;background-color:#d1cfe6;border:2px solid #a19bd1;z-index:2100;}#g-setup *{background:transparent!important;border:0!important;color:#58517c!important;font-family:Verdana,Geneva,sans-serif!important;font-size:10px!important;font-weight:normal!important;letter-spacing:normal!important;line-height:1!important;list-style-type:none!important;margin:0!important;padding:0!important;text-decoration:none!important;text-indent:0!important;text-transform:none!important;word-spacing:0!important;z-index:2100!important;}#g-setup .head{font-weight:bold!important;text-align:center;border-bottom:1px solid #7cb267!important;}#g-setup ul{width:150px;float:left!important;}#g-setup li{clear:left;padding:5px!important;}* html #g-setup li{clear:none!important;padding:4px!important;}#g-setup span{float:left!important;width:50px;padding:1px 4px 0 0!important;text-align:right!important;line-height:1.5!important;}#g-setup input,#g-setup select{float:left!important;width:70px;border:1px solid #a19bd1!important;background-color:#e7e6ee!important;padding:2px!important;}#g-setup select{width:77px;padding:0!important;}#g-setup-misc{margin-top:5px!important;clear:left;float:none!important;width:300px!important;border-top:1px solid #7cb267!important;}#g-setup-misc span{line-height:1.1!important;width:200px;}#g-setup-misc input{width:15px;padding:0!important;height:15px;}#g-setup-tab{width:26px;overflow:hidden;position:absolute;top:0;left:100%;margin-left:-26px!important;z-index:2100!important;}#g-setup-tab img{left:0;position:relative;}#g-grid{left:0;position:absolute;z-index:500;top:0;}#g-grid .g-vertical,#g-grid .g-horizontal{position:absolute;z-index:1000;}*:first-child+html #g-grid .g-horizontal,*:first-child+html #g-grid .g-vertical{margin-left:-1px;}#g-grid .g-horizontal{min-height:1px;height:1px;font-size:0;line-height:0;}</style>').appendTo("head");e.settings.height=jQuery(document).height();if(e.settings.setupEnabled){jQuery('<div id="g-setup"><ul><li class="head">Vertical</li><li><span>Color</span><input id="g-setup-gColor" /></li><li><span>Opacity</span><input id="g-setup-gOpacity" /></li><li><span>Width</span><input id="g-setup-gWidth" /></li><li><span>Columns</span><select id="g-setup-gColumns"></select></li></ul><ul><li class="head">Horizontal</li><li><span>Color</span><input id="g-setup-pColor" /></li><li><span>Opacity</span><input id="g-setup-pOpacity" /></li><li><span>Height</span><input id="g-setup-pHeight" /></li><li><span>Offset</span><input id="g-setup-pOffset" /></li></ul><ul id="g-setup-misc"><li><span>Enable vertical (gutters)</span><input id="g-setup-gEnabled" type="checkbox" /></li><li><span>Enable horizontal (paragraphs)</span><input id="g-setup-pEnabled" type="checkbox" /></li><li><span>Invert vertical</span><input id="g-setup-invert" type="checkbox" /></li><li><span>Center grid</span><input id="g-setup-center" type="checkbox" /></li></ul><div style="clear: left;"></div><div id="g-setup-tab"><a href="javascript:;"><img src="http://gridder.andreehansson.se/releases/1.3.1/logo-sprite.png" alt="" /></a></div></div>').appendTo("body");for(var t=2;t<48;t++){if(Math.round(e.settings.size/t)===e.settings.size/t){jQuery('<option value="'+t+'">'+t+"</option>").appendTo("#g-setup-gColumns")}}for(var t in e.settings){if(jQuery("#g-setup-"+t).length!==0){if(jQuery("#g-setup-"+t).parent().parent().is("#g-setup-misc")&&e.settings[t]){jQuery("#g-setup-"+t).attr("checked","checked")}else{jQuery("#g-setup-"+t).val(e.settings[t])}}}if(!jQuery.support.fixedPosition){jQuery("#g-setup").css("top",jQuery(window).scrollTop()+150)}jQuery("#g-setup-tab a").click(function(){e.toggleSetupWindow()});jQuery("#g-setup input").keyup(function(){var t=this;clearTimeout(e.settings.delayTimer);e.settings.delayTimer=setTimeout(function(){e.setVariable(jQuery(t).attr("id"),jQuery(t).val())},700)});jQuery("#g-setup-gColumns").change(function(){e.setVariable("gColumns",$(this).val())});jQuery("#g-setup-misc input").click(function(){e.setVariable(jQuery(this).attr("id"),jQuery(this).attr("checked"))});jQuery().keydown(function(t){if(jQuery.inArray(t.which,e.settings.pressedKeys)===-1){e.settings.pressedKeys.push(t.which)}});if(!jQuery.support.fixedPosition){jQuery(window).scroll(function(){jQuery("#g-setup").css("top",jQuery().scrollTop()+150)})}}jQuery().keyup(function(t){if(jQuery.inArray(17,e.settings.pressedKeys)!==-1&&jQuery.inArray(18,e.settings.pressedKeys)!==-1){if(jQuery.inArray(90,e.settings.pressedKeys)!==-1){e.setVariable("gEnabled",!e.settings.gEnabled)}else if(jQuery.inArray(88,e.settings.pressedKeys)!==-1){e.setVariable("pEnabled",!e.settings.pEnabled)}else if(jQuery.inArray(65,e.settings.pressedKeys)!==-1){e.setVariable("invert",!e.settings.invert)}else if(jQuery.inArray(67,e.settings.pressedKeys)!==-1){e.setVariable({gEnabled:!e.settings.gEnabled,pEnabled:!e.settings.pEnabled})}}var n=jQuery.inArray(t.which,e.settings.pressedKeys);e.settings.pressedKeys.splice(n,n)})};e.setVariable=function(){if(typeof arguments[0]==="object"){for(var t in arguments[0]){e._setVariable(t,arguments[0][t])}}else{e._setVariable(arguments[0],arguments[1])}e.createGrid()};e.toggleSetupWindow=function(){var e=jQuery("#g-setup-tab img");e.css("left",e.position().left===0?-26:0);if(parseInt(jQuery("#g-setup").css("left"),10)===0){jQuery("#g-setup").animate({left:-310},200)}else{jQuery("#g-setup").animate({left:0},200)}};e.createGrid=function(){jQuery("embed").each(function(){if(e.settings.fixFlash){jQuery(this).attr("wmode","transparent")}else{jQuery(this).removeAttr("wmode")}var t=jQuery(this).wrap("<div></div>").parent().html();jQuery(this).parent().replaceWith(t);jQuery(this).remove()});jQuery("#g-grid").remove();jQuery('<div id="g-grid"></div>').appendTo("body").css("width",e.settings.size);if(e.settings.center){jQuery("#g-grid").css({left:"50%",marginLeft:-(e.settings.size/2)})}if(e.settings.gEnabled&&e.settings.gColumns>0){if(e.settings.invert){jQuery().css("overflow-x","hidden");var t=(jQuery(window).width()-e.settings.size)/2;e._createEntity("vertical",{left:-t,width:t,height:e.settings.height,backgroundColor:e.settings.gColor,opacity:e.settings.gOpacity});for(var n=0;n<e.settings.gColumns;n++){var r=e.settings.size/e.settings.gColumns-e.settings.gWidth*2;var i=e.settings.gWidth*2;e._createEntity("vertical",{left:(r+i)*n+i/2,width:r+"px",height:e.settings.height,backgroundColor:e.settings.gColor,opacity:e.settings.gOpacity})}if(e.settings.height+10>jQuery(window).height()){t-=10}e._createEntity("vertical",{left:"100%",marginLeft:0,width:t,height:e.settings.height,backgroundColor:e.settings.gColor,opacity:e.settings.gOpacity})}else{for(var n=0;n<=e.settings.gColumns;n++){e._createEntity("vertical",{left:n===0?e.settings.size/e.settings.gColumns*n:e.settings.size/e.settings.gColumns*n-e.settings.gWidth,width:n===0||n==e.settings.gColumns?e.settings.gWidth+"px":e.settings.gWidth*2+"px",height:e.settings.height,backgroundColor:e.settings.gColor,opacity:e.settings.gOpacity})}}}if(e.settings.pEnabled&&e.settings.pHeight>1){var s=(e.settings.height-e.settings.pOffset)/e.settings.pHeight;for(n=0;n<=s;n++){e._createEntity("horizontal",{top:e.settings.height/s*n+e.settings.pOffset,left:"50%",marginLeft:-(e.settings.size/2),width:e.settings.size,backgroundColor:e.settings.pColor,opacity:e.settings.pOpacity})}}}}var checkJQuery=function(){if(typeof window.jQuery==="undefined"){setTimeout(function(){checkJQuery()},10)}else{window.grid.setupWindow();window.grid.createGrid()}};if(typeof window.grid==="undefined"){window.grid=new Grid;checkJQuery()}else{window.grid.toggleSetupWindow()}